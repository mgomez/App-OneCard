<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <title>OneCard</title>        
        <script src="js/jquery_1.5.2.min.js"></script>
    </head>
    <body>
        <div id="ocsi">            
            <div class="blink">
                <h1><img src="img/logo.png" alt=""><br><small>Cargando...</small></h1>                
            </div>
        </div>   
        <script src="phonegap.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/PushNotification.js"></script>             
        <script>
!function(a){var b=/iPhone/i,c=/iPod/i,d=/iPad/i,e=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,f=/Android/i,g=/IEMobile/i,h=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,i=/BlackBerry/i,j=/BB10/i,k=/Opera Mini/i,l=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,m=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),n=function(a,b){return a.test(b)},o=function(a){var o=a||navigator.userAgent;return this.apple={phone:n(b,o),ipod:n(c,o),tablet:n(d,o),device:n(b,o)||n(c,o)||n(d,o)},this.android={phone:n(e,o),tablet:!n(e,o)&&n(f,o),device:n(e,o)||n(f,o)},this.windows={phone:n(g,o),tablet:n(h,o),device:n(g,o)||n(h,o)},this.other={blackberry:n(i,o),blackberry10:n(j,o),opera:n(k,o),firefox:n(l,o),device:n(i,o)||n(j,o)||n(k,o)||n(l,o)},this.seven_inch=n(m,o),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window?this:void 0},p=function(){var a=new o;return a.Class=o,a};"undefined"!=typeof module&&module.exports&&"undefined"==typeof window?module.exports=o:"undefined"!=typeof module&&module.exports&&"undefined"!=typeof window?module.exports=p():"function"==typeof define&&define.amd?define(a.isMobile=p()):a.isMobile=p()}(this);
var android = isMobile.android.device;
var ios     = isMobile.apple.device;
var phone   = isMobile.phone;        
var pushNotification;
var networkState;

document.addEventListener('deviceready', onDeviceReady, false);

        function onDeviceReady(){
            networkState = navigator.connection.type;
            if(navigator.notification) {
                window.alert = function (message) {
                    navigator.vibrate(100)
                    navigator.notification.alert(
                        message,    
                        null,       
                        "SmartInvoice", 
                        'OK'        
                    );
                };
            }
            if(networkState != 'none' ){
                navigator.vibrate(1000);            
                var win = window.open("https://onecardservicios.mx/Extranet/AppOneCard");                          
            }else{
                navigator.notification.alert(
                    'No esta conectado a una red Wifi',
                    function(){
                        navigator.app.exitApp();
                    },
                    'SmartInvoice',
                    'Ok'  
                );                
            }                
            //try {
                //pushNotification = window.plugins.pushNotification;
                //console.log(device.platform);
                //if (device.platform == 'android' || device.platform == 'Android' || device.platform == 'amazon-fireos') {
                    //pushNotification.register(successHandler, errorHandler, {
                        //"senderID": "1018280000935",
                        //"ecb": "onNotification"
                    //}); 
                //} else {
                    //pushNotification.register(tokenHandler, errorHandler, {
                        //"badge": "true",
                        //"sound": "true",
                        //"alert": "true",
                        //"ecb": "onNotificationAPN"
                    //});
                //}                            
            //} catch (err) {
                //txt = "Se produjo un error en esta pÃ¡gina.\n\n";
                //txt += "Error: " + err.message + "\n\n";
                //console.log(txt);
                ////onDeviceReady();
            //}   
            if(ios){
                setTimeout(function() {
                    navigator.splashscreen.hide();
                }, 2000);                
            } 
        } 

//function onNotification(e) {
    //console.log(e);
    //switch (e.event) {
        //case 'registered':
            //if (e.regid.length > 0) {
                //console.log("regID = " + e.regid);
                //$.ajax({
                    //url: 'http://betquinielas.com/GCMPushMessage.php',
                    //type: 'POST',
                    //dataType: 'html',
                    //data: {registro:"registro", regID: e.regid, device:device.model},
                //})
                //.done(function(result) {
                    //alert("success: "+result);
                    //console.log(result);
                //})
                //.fail(function(result) {
                    //alert("error: "+result);
                    //console.log(result);
                //})
                //.always(function(result) {
                    //alert("complete: "+result);
                    //console.log(result);
                //});
//                
            //}
            //break;
        //case 'message':
            //if (e.foreground) {
                //console.log(e);
                //var soundfile = e.soundname || e.payload.sound;
                //var my_media = new Media("/android_asset/www/" + soundfile);
                //my_media.play();
            //} else { 
                //console.log(e.foreground)
            //}
            //console.log(e.payload);
            //break;
        //case 'error':
            //console.log(e.msg);
            //break;
        //default:
            //console.log("default");
            //break;
    //}
//}  
//// iOS
//function tokenHandler (result) {
    // Your iOS push server needs to know the token before it can push to this device
    // here is where you might want to send it the token for later use.
    //alert('device token = ' + result);
//}
//function onNotificationAPN (event) {
    //if ( event.alert )    {
        //navigator.notification.alert(event.alert);
    //}
//
    //if ( event.sound ){
        //var snd = new Media(event.sound);
        //snd.play();
    //}
//
    //if ( event.badge ){
        //pushNotification.setApplicationIconBadgeNumber(successHandler, errorHandler, event.badge);
    //}
//}
//
//function successHandler(result){
    //if(result == "OK"){
        //if(networkState != 'none' ){
            //navigator.vibrate(1000);            
            //var win = window.open("https://www.ocsi.mx/Extranet/AppOneCard");
            ////var win = window.open("http://betquinielas.com/test/");                            
        //}else{
            //navigator.notification.alert(
                //'No esta conectado a una red Wifi',
                //function(){
                    //navigator.app.exitApp();
                //},
                //'SmartInvoice',
                //'Ok'  
            //);                
        //}            
    //}
//}     
//
//function errorHandler(result){
    //alert('error = ' + error);
//}        
        </script>
    </body>
</html>
