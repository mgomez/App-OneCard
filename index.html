<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <title>OneCard</title>        
        <script src="js/jquery_1.5.2.min.js"></script>
    </head>
    <body>
        <div id="ocsi">            
            <div class="blink">
                <h1><img src="img/logo.png" alt=""><br><small>Cargando...</small></h1>                
            </div>
        </div>   
        <p>
            <a href="#" id="login-with-facebook">LOGIN FACEBOOK</a>s
        </p>
        <script src="phonegap.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/PushNotification.js"></script>             
        <script>
!function(a){var b=/iPhone/i,c=/iPod/i,d=/iPad/i,e=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,f=/Android/i,g=/IEMobile/i,h=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,i=/BlackBerry/i,j=/BB10/i,k=/Opera Mini/i,l=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,m=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),n=function(a,b){return a.test(b)},o=function(a){var o=a||navigator.userAgent;return this.apple={phone:n(b,o),ipod:n(c,o),tablet:n(d,o),device:n(b,o)||n(c,o)||n(d,o)},this.android={phone:n(e,o),tablet:!n(e,o)&&n(f,o),device:n(e,o)||n(f,o)},this.windows={phone:n(g,o),tablet:n(h,o),device:n(g,o)||n(h,o)},this.other={blackberry:n(i,o),blackberry10:n(j,o),opera:n(k,o),firefox:n(l,o),device:n(i,o)||n(j,o)||n(k,o)||n(l,o)},this.seven_inch=n(m,o),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window?this:void 0},p=function(){var a=new o;return a.Class=o,a};"undefined"!=typeof module&&module.exports&&"undefined"==typeof window?module.exports=o:"undefined"!=typeof module&&module.exports&&"undefined"!=typeof window?module.exports=p():"function"==typeof define&&define.amd?define(a.isMobile=p()):a.isMobile=p()}(this);
var android = isMobile.android.device;
var ios = isMobile.apple.device;
var phone = isMobile.phone;
var pushNotification;
var networkState;

document.addEventListener('deviceready', onDeviceReady, false);

function onDeviceReady() {
    if (typeof CDV === 'undefined') {
        alert('CDV variable does not exist. Check that you have included cdv-plugin-fb-connect.js correctly');
    }
    if (typeof FB === 'undefined') {
        alert('FB variable does not exist. Check that you have included the Facebook JS SDK file.');
    }
    networkState = navigator.connection.type;
    if (navigator.notification) {
        window.alert = function(message) {
            navigator.vibrate(100)
            navigator.notification.alert(message, null, "OneCard", 'OK');
        };
    }
    if (networkState != 'none') {
        navigator.vibrate(1000);
        //var win = window.open("https://www.onecardservicios.mx/Extranet/AppOneCard/Account/Login");
    } else {
        navigator.notification.alert('Intentelo de nuevo conectado cuando tenga acceso a internet', function() {
            navigator.app.exitApp();
        }, 'OneCard', 'Ok');
    }
    if (ios) {
        setTimeout(function() {
            navigator.splashscreen.hide();
        }, 2000);
    }
    //Login Facebook
    try {
        FB.init({
            appId: "348393422017579",
            nativeInterface: CDV.FB,
            useCachedDialogs: false
        });
    } catch (e) {
        alert(e);
    }    
    //facebookConnectPlugin.browserInit("348393422017579");
    //facebookConnectPlugin.login(Array strings of permissions, Function (success){console.log(success)}, Function (failure){console.log(failure)});
    //var fbLoginSuccess = function (userData) {
        //alert("UserInfo: " + JSON.stringify(userData));
        //console.log(userData);
    //}
    //facebookConnectPlugin.login(["public_profile"],
        //fbLoginSuccess,
        //function (error) { alert("" + error);console.log(error); }
    //);    
}
var loginButton = $('#login-with-facebook');
 
loginButton.on('click', function(e) {
    e.preventDefault();
 
    FB.login(function(response) {
        if (response.status === 'connected') {
            alert('logged in');
        } else {
            alert('not logged in');
        }
    },{ scope: "email" });
 
});       
        </script>
    </body>
</html>
